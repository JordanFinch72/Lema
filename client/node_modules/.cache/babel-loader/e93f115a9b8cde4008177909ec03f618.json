{"ast":null,"code":"var _jsxFileName = \"D:\\\\xampp\\\\htdocs\\\\COMP3000_LEMA\\\\Project\\\\lema\\\\src\\\\components\\\\Collection.jsx\";\nimport React, { Component } from \"react\";\nimport { Meatballs } from \"./Meatballs\";\nimport { Collapser } from \"./Collapser\";\nimport { AddEditCollectionModal } from \"./AddEditCollectionModal\";\nimport { AddEditNodeModal } from \"./AddEditNodeModal\";\nimport { Button } from \"./Button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass CollectionNode extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let nodeColour = this.props.node.colour || \"blue\"; // TODO: Advanced logic for determining next unused colour (per journey)\n\n    let changeColourTimeout;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"collection-node\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: e => {\n          this.props.openModal(e, /*#__PURE__*/_jsxDEV(AddEditNodeModal, {\n            flatCollection: this.props.flatCollection,\n            words: this.props.words,\n            type: this.props.type,\n            node: this.props.node,\n            language: this.props.node.language,\n            onNodeSubmit: this.props.editNode,\n            collectionIndex: this.props.collectionIndex,\n            indexChain: this.props.indexChain\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 25,\n            columnNumber: 30\n          }, this));\n        },\n        children: this.props.node.word\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: e => {\n          this.props.openModal(e, /*#__PURE__*/_jsxDEV(AddEditNodeModal, {\n            flatCollection: this.props.flatCollection,\n            words: this.props.words,\n            type: this.props.type,\n            node: this.props.node,\n            language: this.props.node.language,\n            onNodeSubmit: this.props.editNode,\n            collectionIndex: this.props.collectionIndex,\n            indexChain: this.props.indexChain\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 30\n          }, this));\n        },\n        children: this.props.node.language\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttons-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"color\",\n          defaultValue: this.props.node.colour,\n          onChange: e => {\n            // Throttle the onChange; there's no way to have it only change when the user clicks off of it, annoyingly\n            let node = this;\n            window.clearTimeout(changeColourTimeout);\n            changeColourTimeout = window.setTimeout(function () {\n              let updatedNode = { ...node,\n                colour: e.target.value\n              };\n              node.props.editNode(e, node.props.collectionIndex, node.props.indexChain, updatedNode);\n            }, 100);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          value: \"X\",\n          id: \"remove-node\",\n          onClick: e => this.props.removeNode(e, this.props.collectionIndex, this.props.indexChain)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 4\n    }, this);\n  }\n\n}\n\nexport class Collection extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      collapsed: false // Note: Could be lifted if we want persistence when editing types\n\n    };\n    this.flatCollection = [];\n    this.toggleCollapse = this.toggleCollapse.bind(this);\n    this.getCollectionWords = this.getCollectionWords.bind(this);\n  }\n\n  toggleCollapse(e) {\n    this.setState({\n      collapsed: !this.state.collapsed\n    });\n  }\n  /**\r\n   * Recursive algorithm that adds a CollectionNode component for each word in a collection\r\n   * @param {*} wordComponents An initially empty array that contains the CollectionNode components\r\n   * @param {*} node The currently worked-on node for this depth level\r\n   * @param {number} i The index of the currently worked-on node\r\n   * @param {string} indexChain The chain of indexes required to get to the node (e.g. this.props.words[0].parents[1].parents[4] would have a chain of 0,1,4)\r\n   * @param {string} collectionIndex The index of the collection that the node belongs to\r\n   */\n\n\n  getCollectionWords(wordComponents, node, i, indexChain, collectionIndex) {\n    indexChain += String(i);\n\n    if (node.parents) {\n      for (let j = 0; j < node.parents.length; ++j) {\n        wordComponents = this.getCollectionWords(wordComponents, node.parents[j], j, indexChain + \"->\", collectionIndex);\n      }\n    }\n\n    node.indexChain = indexChain;\n    if (!this.flatCollection.includes(node)) this.flatCollection.push(node);\n    wordComponents.push( /*#__PURE__*/_jsxDEV(CollectionNode, {\n      type: this.props.type,\n      words: this.props.words,\n      node: node,\n      editNode: this.props.editNode,\n      removeNode: this.props.removeNode,\n      openModal: this.props.openModal,\n      collectionIndex: collectionIndex // Index of collection the node belongs to\n      ,\n      indexChain: indexChain // Index chain pointing to word in the tree\n\n    }, indexChain, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 23\n    }, this));\n    return wordComponents;\n  }\n\n  render() {\n    let wordComponents = [];\n\n    if (!this.state.collapsed) {\n      if (this.props.words.length > 0) wordComponents = this.getCollectionWords(wordComponents, this.props.words[0], 0, \"\", this.props.index);\n\n      for (let i = 0; i < wordComponents; ++i) {\n        let component = wordComponents[i];\n        component = /*#__PURE__*/React.cloneElement(component, {\n          flatCollection: this.flatCollection\n        });\n      }\n    }\n\n    let meatballItems = [{\n      text: \"Add node\",\n      handler: e => {\n        this.props.cAddNode(e, {\n          flatCollection: this.flatCollection,\n          type: this.props.type,\n          collectionIndex: this.props.index\n        });\n      }\n    }, {\n      text: \"Add node (default)\",\n      handler: e => {\n        this.props.cAddNodeDefault(e, {\n          type: this.props.type,\n          collectionIndex: this.props.index\n        });\n      }\n    }, {\n      text: \"Remove collection\",\n      handler: e => {\n        this.props.cRemoveCollection(e, this.props.index);\n      }\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"collection-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"collection-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: e => {\n            this.openModal(e, /*#__PURE__*/_jsxDEV(AddEditCollectionModal, {\n              type: this.props.type,\n              word: this.props.header.word,\n              language: this.props.header.language,\n              onCollectionSubmit: this.props.editCollection,\n              index: this.props.index\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 25\n            }, this));\n          },\n          children: this.props.header.word\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: e => {\n            this.openModal(e, /*#__PURE__*/_jsxDEV(AddEditCollectionModal, {\n              type: this.props.type,\n              word: this.props.header.word,\n              language: this.props.header.language,\n              onCollectionSubmit: this.props.editCollection,\n              index: this.props.index\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 25\n            }, this));\n          },\n          children: this.props.header.language\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"meatball-collapser-container\",\n          children: [/*#__PURE__*/_jsxDEV(Meatballs, {\n            openModal: this.props.openModal,\n            openContextMenu: this.props.openContextMenu,\n            closeContextMenu: this.props.closeContextMenu,\n            contextMenuItems: meatballItems\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(Collapser, {\n            toggleCollapse: this.toggleCollapse,\n            collapsed: this.state.collapsed\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 5\n      }, this), wordComponents]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["D:/xampp/htdocs/COMP3000_LEMA/Project/lema/src/components/Collection.jsx"],"names":["React","Component","Meatballs","Collapser","AddEditCollectionModal","AddEditNodeModal","Button","CollectionNode","constructor","props","render","nodeColour","node","colour","changeColourTimeout","e","openModal","flatCollection","words","type","language","editNode","collectionIndex","indexChain","word","window","clearTimeout","setTimeout","updatedNode","target","value","removeNode","Collection","state","collapsed","toggleCollapse","bind","getCollectionWords","setState","wordComponents","i","String","parents","j","length","includes","push","index","component","cloneElement","meatballItems","text","handler","cAddNode","cAddNodeDefault","cRemoveCollection","header","editCollection","openContextMenu","closeContextMenu"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport {Meatballs} from \"./Meatballs\";\r\nimport {Collapser} from \"./Collapser\";\r\nimport {AddEditCollectionModal} from \"./AddEditCollectionModal\";\r\nimport {AddEditNodeModal} from \"./AddEditNodeModal\";\r\nimport {Button} from \"./Button\";\r\n\r\nclass CollectionNode extends Component\r\n{\r\n\tconstructor(props)\r\n\t{\r\n\t\tsuper(props);\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tlet nodeColour = this.props.node.colour || \"blue\"; // TODO: Advanced logic for determining next unused colour (per journey)\r\n\t\tlet changeColourTimeout;\r\n\r\n\t\treturn (\r\n\t\t\t<div className={\"collection-node\"}>\r\n\t\t\t\t{/* Flex-row */}\r\n\t\t\t\t<div onClick={(e) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.props.openModal(e, <AddEditNodeModal\r\n\t\t\t\t\t\tflatCollection={this.props.flatCollection}\r\n\t\t\t\t\t\twords={this.props.words}\r\n\t\t\t\t\t\ttype={this.props.type}\r\n\t\t\t\t\t\tnode={this.props.node}\r\n\t\t\t\t\t\tlanguage={this.props.node.language}\r\n\t\t\t\t\t\tonNodeSubmit={this.props.editNode}\r\n\t\t\t\t\t\tcollectionIndex={this.props.collectionIndex}\r\n\t\t\t\t\t\tindexChain={this.props.indexChain}\r\n\t\t\t\t\t/>);\r\n\t\t\t\t}}>{this.props.node.word}</div>\r\n\t\t\t\t<div onClick={(e) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.props.openModal(e, <AddEditNodeModal\r\n\t\t\t\t\t\tflatCollection={this.props.flatCollection}\r\n\t\t\t\t\t\twords={this.props.words}\r\n\t\t\t\t\t\ttype={this.props.type}\r\n\t\t\t\t\t\tnode={this.props.node}\r\n\t\t\t\t\t\tlanguage={this.props.node.language}\r\n\t\t\t\t\t\tonNodeSubmit={this.props.editNode}\r\n\t\t\t\t\t\tcollectionIndex={this.props.collectionIndex}\r\n\t\t\t\t\t\tindexChain={this.props.indexChain}\r\n\t\t\t\t\t/>);\r\n\t\t\t\t}}>{this.props.node.language}</div>\r\n\t\t\t\t<div className={\"buttons-container\"}>\r\n\t\t\t\t\t<input type={\"color\"} defaultValue={this.props.node.colour} onChange={(e) => {\r\n\t\t\t\t\t\t// Throttle the onChange; there's no way to have it only change when the user clicks off of it, annoyingly\r\n\t\t\t\t\t\tlet node = this;\r\n\t\t\t\t\t\twindow.clearTimeout(changeColourTimeout);\r\n\t\t\t\t\t\tchangeColourTimeout = window.setTimeout(function()\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlet updatedNode = {\r\n\t\t\t\t\t\t\t\t...node,\r\n\t\t\t\t\t\t\t\t\tcolour: e.target.value\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tnode.props.editNode(e, node.props.collectionIndex, node.props.indexChain, updatedNode);\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<Button value={\"X\"} id={\"remove-node\"}\r\n\t\t\t\t\t        onClick={(e) => this.props.removeNode(e, this.props.collectionIndex, this.props.indexChain)}/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport class Collection extends Component\r\n{\r\n\tconstructor(props)\r\n\t{\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tcollapsed: false, // Note: Could be lifted if we want persistence when editing types\r\n\t\t};\r\n\r\n\t\tthis.flatCollection = [];\r\n\t\tthis.toggleCollapse = this.toggleCollapse.bind(this);\r\n\t\tthis.getCollectionWords = this.getCollectionWords.bind(this);\r\n\t}\r\n\r\n\ttoggleCollapse(e)\r\n\t{\r\n\t\tthis.setState({collapsed: !this.state.collapsed});\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Recursive algorithm that adds a CollectionNode component for each word in a collection\r\n\t * @param {*} wordComponents An initially empty array that contains the CollectionNode components\r\n\t * @param {*} node The currently worked-on node for this depth level\r\n\t * @param {number} i The index of the currently worked-on node\r\n\t * @param {string} indexChain The chain of indexes required to get to the node (e.g. this.props.words[0].parents[1].parents[4] would have a chain of 0,1,4)\r\n\t * @param {string} collectionIndex The index of the collection that the node belongs to\r\n\t */\r\n\tgetCollectionWords(wordComponents, node, i, indexChain, collectionIndex)\r\n\t{\r\n\t\tindexChain += String(i);\r\n\t\tif(node.parents)\r\n\t\t{\r\n\t\t\tfor(let j = 0; j < node.parents.length; ++j)\r\n\t\t\t{\r\n\t\t\t\twordComponents = this.getCollectionWords(wordComponents, node.parents[j], j, indexChain + \"->\", collectionIndex);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tnode.indexChain = indexChain;\r\n\t\tif(!this.flatCollection.includes(node)) this.flatCollection.push(node);\r\n\t\twordComponents.push(<CollectionNode\r\n\t\t\tkey={indexChain}\r\n\t\t\ttype={this.props.type}\r\n\t\t\twords={this.props.words}\r\n\t\t\tnode={node}\r\n\t\t\teditNode={this.props.editNode}\r\n\t\t\tremoveNode={this.props.removeNode}\r\n\t\t\topenModal={this.props.openModal}\r\n\t\t\tcollectionIndex={collectionIndex}  // Index of collection the node belongs to\r\n\t\t\tindexChain={indexChain}            // Index chain pointing to word in the tree\r\n\t\t/>);\r\n\r\n\t\treturn wordComponents;\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tlet wordComponents = [];\r\n\r\n\t\tif(!this.state.collapsed)\r\n\t\t{\r\n\t\t\tif(this.props.words.length > 0)\r\n\t\t\t\twordComponents = this.getCollectionWords(wordComponents, this.props.words[0], 0, \"\", this.props.index);\r\n\r\n\t\t\tfor(let i = 0; i < wordComponents; ++i)\r\n\t\t\t{\r\n\t\t\t\tlet component = wordComponents[i];\r\n\t\t\t\tcomponent = React.cloneElement(component, {flatCollection: this.flatCollection});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet meatballItems = [\r\n\t\t\t{\r\n\t\t\t\ttext: \"Add node\", handler: (e) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.props.cAddNode(e, {flatCollection: this.flatCollection, type: this.props.type, collectionIndex: this.props.index});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: \"Add node (default)\", handler: (e) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.props.cAddNodeDefault(e, {type: this.props.type, collectionIndex: this.props.index});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: \"Remove collection\", handler: (e) =>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.props.cRemoveCollection(e, this.props.index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\treturn (\r\n\t\t\t<div className={\"collection-container\"}>\r\n\t\t\t\t<div className={\"collection-header\"}>\r\n\t\t\t\t\t{/* Flex-row */}\r\n\t\t\t\t\t<div onClick={(e) =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.openModal(e, <AddEditCollectionModal\r\n\t\t\t\t\t\t\ttype={this.props.type}\r\n\t\t\t\t\t\t\tword={this.props.header.word}\r\n\t\t\t\t\t\t\tlanguage={this.props.header.language}\r\n\t\t\t\t\t\t\tonCollectionSubmit={this.props.editCollection}\r\n\t\t\t\t\t\t\tindex={this.props.index}\r\n\t\t\t\t\t\t/>);\r\n\t\t\t\t\t}}>{this.props.header.word}</div>\r\n\t\t\t\t\t<div onClick={(e) =>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.openModal(e, <AddEditCollectionModal\r\n\t\t\t\t\t\t\ttype={this.props.type}\r\n\t\t\t\t\t\t\tword={this.props.header.word}\r\n\t\t\t\t\t\t\tlanguage={this.props.header.language}\r\n\t\t\t\t\t\t\tonCollectionSubmit={this.props.editCollection}\r\n\t\t\t\t\t\t\tindex={this.props.index}\r\n\t\t\t\t\t\t/>);\r\n\t\t\t\t\t}}>{this.props.header.language}</div>\r\n\t\t\t\t\t<div className={\"meatball-collapser-container\"}>\r\n\t\t\t\t\t\t<Meatballs openModal={this.props.openModal} openContextMenu={this.props.openContextMenu}\r\n\t\t\t\t\t\t           closeContextMenu={this.props.closeContextMenu} contextMenuItems={meatballItems}/>\r\n\t\t\t\t\t\t<Collapser toggleCollapse={this.toggleCollapse} collapsed={this.state.collapsed}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{wordComponents}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}"]},"metadata":{},"sourceType":"module"}